<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>BATS · Durbyn.jl</title><meta name="title" content="BATS · Durbyn.jl"/><meta property="og:title" content="BATS · Durbyn.jl"/><meta property="twitter:title" content="BATS · Durbyn.jl"/><meta name="description" content="Documentation for Durbyn.jl."/><meta property="og:description" content="Documentation for Durbyn.jl."/><meta property="twitter:description" content="Documentation for Durbyn.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/theme.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Durbyn.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Durbyn.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quickstart/">Quick Start</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../grammar/">Grammar</a></li><li><a class="tocitem" href="../naive/">Naive Methods</a></li><li><a class="tocitem" href="../expsmoothing/">Exponential Smoothing</a></li><li><a class="tocitem" href="../theta/">Theta</a></li><li class="is-active"><a class="tocitem" href>BATS</a><ul class="internal"><li><a class="tocitem" href="#1.-Box–Cox-transformation"><span>1. Box–Cox transformation</span></a></li><li><a class="tocitem" href="#2.-BATS-state-space-formulation"><span>2. BATS state-space formulation</span></a></li><li><a class="tocitem" href="#3.-Limitations-and-relation-to-TBATS"><span>3. Limitations and relation to TBATS</span></a></li><li><a class="tocitem" href="#4.-Usage-in-Durbyn"><span>4. Usage in Durbyn</span></a></li><li><a class="tocitem" href="#5.-Reference"><span>5. Reference</span></a></li></ul></li><li><a class="tocitem" href="../tbats/">TBATS</a></li><li><a class="tocitem" href="../intermittent/">Intermittent Demand</a></li><li><a class="tocitem" href="../arima/">ARIMA</a></li><li><a class="tocitem" href="../diffusion/">Diffusion</a></li><li><a class="tocitem" href="../arar/">ARAR</a></li><li><a class="tocitem" href="../ararma/">ARARMA</a></li><li><a class="tocitem" href="../stats/">Statistics</a></li><li><a class="tocitem" href="../optimize/">Optimization</a></li><li><a class="tocitem" href="../utils/">Utilities</a></li><li><a class="tocitem" href="../tableops/">Table Operations</a></li></ul></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>BATS</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>BATS</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/taf-society/Durbyn.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/taf-society/Durbyn.jl/blob/main/docs/src/bats.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="BATS:-Box-Cox,-ARMA-errors,-Trend,-Seasonal-Models"><a class="docs-heading-anchor" href="#BATS:-Box-Cox,-ARMA-errors,-Trend,-Seasonal-Models">BATS: Box-Cox, ARMA errors, Trend, Seasonal Models</a><a id="BATS:-Box-Cox,-ARMA-errors,-Trend,-Seasonal-Models-1"></a><a class="docs-heading-anchor-permalink" href="#BATS:-Box-Cox,-ARMA-errors,-Trend,-Seasonal-Models" title="Permalink"></a></h1><p>The <strong>BATS</strong> framework extends exponential smoothing to accommodate multiple, possibly long seasonal cycles together with Box–Cox variance stabilization and ARMA error correction. It was introduced by De Livera, Hyndman &amp; Snyder (2011) as part of the innovation-state-space family and is the method implemented by Durbyn’s [<code>bats</code>] function.</p><p>This page summarizes the core equations, highlights limitations (and why TBATS was proposed in the paper), and shows how to use the Julia interface.</p><hr/><h2 id="1.-Box–Cox-transformation"><a class="docs-heading-anchor" href="#1.-Box–Cox-transformation">1. Box–Cox transformation</a><a id="1.-Box–Cox-transformation-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Box–Cox-transformation" title="Permalink"></a></h2><p>Each BATS model may apply a Box–Cox transformation to the observed series, which stabilizes variance prior to modeling:</p><p class="math-container">\[y_t^{(\omega)} =
\begin{cases}
\dfrac{y_t^\omega - 1}{\omega}, &amp; \omega \neq 0, \\
\ln y_t, &amp; \omega = 0 .
\end{cases}\]</p><p>The parameter <span>$\omega$</span> (often denoted <span>$\lambda$</span> in code) is estimated within the automated model search when the user permits Box–Cox transforms.</p><hr/><h2 id="2.-BATS-state-space-formulation"><a class="docs-heading-anchor" href="#2.-BATS-state-space-formulation">2. BATS state-space formulation</a><a id="2.-BATS-state-space-formulation-1"></a><a class="docs-heading-anchor-permalink" href="#2.-BATS-state-space-formulation" title="Permalink"></a></h2><p>After optional transformation, BATS is written in innovations form with an ARMA error process.</p><h3 id="Observation-equation"><a class="docs-heading-anchor" href="#Observation-equation">Observation equation</a><a id="Observation-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Observation-equation" title="Permalink"></a></h3><p class="math-container">\[y_t^{(\omega)} = \ell_{t-1} + \phi b_{t-1} + \sum_i s_{i,t-1} + d_t,\]</p><p>where <span>$\ell_t$</span> is the level, <span>$b_t$</span> the trend, <span>$\phi$</span> the damping parameter, <span>$s_{i,t}$</span> the seasonal state for seasonal period <span>$m_i$</span>, and <span>$d_t$</span> the ARMA error term.</p><h3 id="State-equations"><a class="docs-heading-anchor" href="#State-equations">State equations</a><a id="State-equations-1"></a><a class="docs-heading-anchor-permalink" href="#State-equations" title="Permalink"></a></h3><p>Level and trend:</p><p class="math-container">\[\ell_t = \ell_{t-1} + \phi b_{t-1} + \alpha d_t, \qquad
b_t = \phi b_{t-1} + \beta d_t.\]</p><p>Additive seasonality for each seasonal block <span>$i$</span> (normalized form):</p><p class="math-container">\[s_{i,t} = -\sum_{j=1}^{m_i-1} s_{i,t-j} + \gamma_i d_t.\]</p><h3 id="ARMA-error-component"><a class="docs-heading-anchor" href="#ARMA-error-component">ARMA error component</a><a id="ARMA-error-component-1"></a><a class="docs-heading-anchor-permalink" href="#ARMA-error-component" title="Permalink"></a></h3><p class="math-container">\[d_t = \varepsilon_t + \sum_{k=1}^p \varphi_k \varepsilon_{t-k}
      + \sum_{\ell=1}^q \theta_\ell d_{t-\ell},
\qquad \varepsilon_t \sim \mathcal{N}(0, \sigma^2).\]</p><p>Combining these pieces yields the descriptor <code>BATS(ω, {p,q}, φ, {m₁,…,m_J})</code> that Durbyn prints for each fitted model.</p><hr/><h2 id="3.-Limitations-and-relation-to-TBATS"><a class="docs-heading-anchor" href="#3.-Limitations-and-relation-to-TBATS">3. Limitations and relation to TBATS</a><a id="3.-Limitations-and-relation-to-TBATS-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Limitations-and-relation-to-TBATS" title="Permalink"></a></h2><p>In the original paper, TBATS was introduced to address several BATS limitations:</p><ul><li>Seasonal periods must be integers, and each requires storing <span>$m_i$</span> state components, which becomes expensive for very long cycles.</li><li>Non-integer or dual-calendar seasonalities (e.g., Hijri and Gregorian) cannot be represented exactly.</li></ul><p>TBATS replaces the seasonal states with Fourier (trigonometric) terms to overcome those issues. <strong>Durbyn provides both BATS and TBATS implementations.</strong> The <code>bats</code> function corresponds strictly to the BATS formulation above for integer seasonal periods, while <code>tbats</code> supports non-integer periods and more efficient handling of long seasonal cycles via Fourier representation.</p><div class="admonition is-info" id="TBATS-documentation-55aec6023c937d62"><header class="admonition-header">TBATS documentation<a class="admonition-anchor" href="#TBATS-documentation-55aec6023c937d62" title="Permalink"></a></header><div class="admonition-body"><p>For detailed information about TBATS, including non-integer seasonal periods, dual calendar effects, and computational efficiency, see the <a href="../tbats/">TBATS documentation</a>.</p></div></div><hr/><h2 id="4.-Usage-in-Durbyn"><a class="docs-heading-anchor" href="#4.-Usage-in-Durbyn">4. Usage in Durbyn</a><a id="4.-Usage-in-Durbyn-1"></a><a class="docs-heading-anchor-permalink" href="#4.-Usage-in-Durbyn" title="Permalink"></a></h2><p>Durbyn provides two interfaces for BATS: the <strong>classic API</strong> with direct function calls and the <strong>grammar interface</strong> for declarative model specification.</p><h3 id="Grammar-Interface-(Recommended)"><a class="docs-heading-anchor" href="#Grammar-Interface-(Recommended)">Grammar Interface (Recommended)</a><a id="Grammar-Interface-(Recommended)-1"></a><a class="docs-heading-anchor-permalink" href="#Grammar-Interface-(Recommended)" title="Permalink"></a></h3><p>The grammar interface provides a unified, declarative way to specify BATS models using <code>@formula</code> and <code>BatsSpec</code>:</p><pre><code class="language-julia hljs">using Durbyn
using Durbyn.ModelSpecs

# Create sample data
data = (sales = randn(120) .+ 10,)

# Basic BATS with defaults (automatic component selection)
spec = BatsSpec(@formula(sales = bats()))
fitted = fit(spec, data)
fc = forecast(fitted, h = 12)

# BATS with monthly seasonality
spec = BatsSpec(@formula(sales = bats(seasonal_periods=12)))
fitted = fit(spec, data)
fc = forecast(fitted, h = 12)

# BATS with multiple seasonal periods (e.g., hourly data with daily and weekly)
spec = BatsSpec(@formula(sales = bats(seasonal_periods=[24, 168])))
fitted = fit(spec, data)
fc = forecast(fitted, h = 12)

# BATS with specific component selection
spec = BatsSpec(@formula(sales = bats(
    seasonal_periods=12,
    use_box_cox=true,
    use_trend=true,
    use_damped_trend=false,
    use_arma_errors=true
)))
fitted = fit(spec, data)
fc = forecast(fitted, h = 12)

# Additional options at fit time
fitted = fit(spec, data, bc_lower=0.0, bc_upper=1.5, biasadj=true)</code></pre><p><strong>Panel Data Support:</strong></p><pre><code class="language-julia hljs"># Create panel data (Tables.jl compatible)
tbl = (
    date = repeat(1:120, 3),
    product = repeat([&quot;A&quot;, &quot;B&quot;, &quot;C&quot;], inner=120),
    sales = randn(360) .+ 10
)

# Fit BATS to each product separately
spec = BatsSpec(@formula(sales = bats(seasonal_periods=12)))
fitted = fit(spec, tbl, groupby = :product)
fc = forecast(fitted, h = 12)</code></pre><p><strong>Model Comparison:</strong></p><pre><code class="language-julia hljs">models = model(
    BatsSpec(@formula(sales = bats(seasonal_periods=12))),
    ArimaSpec(@formula(sales = p() + q() + P() + Q())),
    EtsSpec(@formula(sales = e(&quot;Z&quot;) + t(&quot;Z&quot;) + s(&quot;Z&quot;))),
    names = [&quot;bats&quot;, &quot;arima&quot;, &quot;ets&quot;]
)

fitted = fit(models, data)
fc = forecast(fitted, h = 12)</code></pre><h3 id="Classic-API"><a class="docs-heading-anchor" href="#Classic-API">Classic API</a><a id="Classic-API-1"></a><a class="docs-heading-anchor-permalink" href="#Classic-API" title="Permalink"></a></h3><p>For direct usage without the grammar interface:</p><pre><code class="language-julia hljs">using Durbyn

# Hourly demand with weekly (24*7) and yearly (24*365) seasonality
m = [168, 8760]
fit = bats(load, m; use_box_cox = true, use_arma_errors = true)

println(string(fit))
fc = forecast(fit; h = 168)</code></pre><h3 id="Formula-Interface-(Direct)"><a class="docs-heading-anchor" href="#Formula-Interface-(Direct)">Formula Interface (Direct)</a><a id="Formula-Interface-(Direct)-1"></a><a class="docs-heading-anchor-permalink" href="#Formula-Interface-(Direct)" title="Permalink"></a></h3><p>You can also use the formula interface directly without <code>BatsSpec</code>:</p><pre><code class="language-julia hljs">using Durbyn

data = (sales = randn(120) .+ 10,)
formula = @formula(sales = bats(seasonal_periods=12))
fit = bats(formula, data)  # Works with Tables.jl compatible data
fc = forecast(fit, h = 12)</code></pre><h3 id="Key-keyword-arguments"><a class="docs-heading-anchor" href="#Key-keyword-arguments">Key keyword arguments</a><a id="Key-keyword-arguments-1"></a><a class="docs-heading-anchor-permalink" href="#Key-keyword-arguments" title="Permalink"></a></h3><ul><li><code>seasonal_periods</code>: <code>Int</code> or <code>Vector{Int}</code> specifying seasonal period(s)</li><li><code>use_box_cox</code>, <code>use_trend</code>, <code>use_damped_trend</code>: <code>Bool</code>, <code>Vector{Bool}</code>, or <code>nothing</code> to try both options; the best combination is chosen using AIC.</li><li><code>use_arma_errors</code>: toggles fitting an ARMA(p, q) model to the residuals via [<code>auto_arima</code>]; if the selected ARMA orders are zero, the pure exponential-smoothing state-space model is retained.</li><li><code>bc_lower</code>, <code>bc_upper</code>: bounds for the Box–Cox search when enabled.</li><li><code>biasadj</code>: apply bias correction during inverse Box–Cox transformation.</li><li><code>model</code>: pass a previous <code>BATSModel</code> to refit the same structure to new data without re-running the full model selection process.</li></ul><p>The convenience method <code>bats(y, m::Int; kwargs...)</code> simply wraps the vector interface (<code>[m]</code>), making single-season calls ergonomic.</p><hr/><h2 id="5.-Reference"><a class="docs-heading-anchor" href="#5.-Reference">5. Reference</a><a id="5.-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#5.-Reference" title="Permalink"></a></h2><ul><li>De Livera, A.M., Hyndman, R.J., &amp; Snyder, R.D. (2011). <a href="https://www.tandfonline.com/doi/abs/10.1198/jasa.2011.tm09771"><em>Forecasting time series with complex seasonal patterns using exponential smoothing.</em></a> Journal of the American Statistical Association, 106(496), 1513–1527.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theta/">« Theta</a><a class="docs-footer-nextpage" href="../tbats/">TBATS »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 10 February 2026 14:17">Tuesday 10 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
