<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>TBATS · Durbyn.jl</title><meta name="title" content="TBATS · Durbyn.jl"/><meta property="og:title" content="TBATS · Durbyn.jl"/><meta property="twitter:title" content="TBATS · Durbyn.jl"/><meta name="description" content="Documentation for Durbyn.jl."/><meta property="og:description" content="Documentation for Durbyn.jl."/><meta property="twitter:description" content="Documentation for Durbyn.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/theme.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Durbyn.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Durbyn.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quickstart/">Quick Start</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../grammar/">Grammar</a></li><li><a class="tocitem" href="../expsmoothing/">Exponential Smoothing</a></li><li><a class="tocitem" href="../theta/">Theta</a></li><li><a class="tocitem" href="../bats/">BATS</a></li><li class="is-active"><a class="tocitem" href>TBATS</a><ul class="internal"><li><a class="tocitem" href="#Mathematical-Framework"><span>Mathematical Framework</span></a></li><li><a class="tocitem" href="#Usage-in-Durbyn"><span>Usage in Durbyn</span></a></li><li><a class="tocitem" href="#Julia-Implementation-(Array-Interface)"><span>Julia Implementation (Array Interface)</span></a></li><li><a class="tocitem" href="#Model-Selection"><span>Model Selection</span></a></li><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li><li><a class="tocitem" href="#Forecasting"><span>Forecasting</span></a></li><li><a class="tocitem" href="#Model-Diagnostics"><span>Model Diagnostics</span></a></li><li><a class="tocitem" href="#Computational-Considerations"><span>Computational Considerations</span></a></li><li><a class="tocitem" href="#Empirical-Results-(From-De-Livera-et-al.-2011)"><span>Empirical Results (From De Livera et al. 2011)</span></a></li><li><a class="tocitem" href="#Comparison:-BATS-vs-TBATS"><span>Comparison: BATS vs TBATS</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li><li><a class="tocitem" href="#See-Also"><span>See Also</span></a></li></ul></li><li><a class="tocitem" href="../intermittent/">Intermittent Demand</a></li><li><a class="tocitem" href="../arima/">ARIMA</a></li><li><a class="tocitem" href="../arar/">ARAR</a></li><li><a class="tocitem" href="../ararma/">ARARMA</a></li><li><a class="tocitem" href="../stats/">Statistics</a></li><li><a class="tocitem" href="../optimize/">Optimization</a></li><li><a class="tocitem" href="../utils/">Utilities</a></li><li><a class="tocitem" href="../tableops/">Table Operations</a></li></ul></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>TBATS</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>TBATS</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/taf-society/Durbyn.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/taf-society/Durbyn.jl/blob/main/docs/src/tbats.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="TBATS:-Trigonometric-Seasonal-Exponential-Smoothing"><a class="docs-heading-anchor" href="#TBATS:-Trigonometric-Seasonal-Exponential-Smoothing">TBATS: Trigonometric Seasonal Exponential Smoothing</a><a id="TBATS:-Trigonometric-Seasonal-Exponential-Smoothing-1"></a><a class="docs-heading-anchor-permalink" href="#TBATS:-Trigonometric-Seasonal-Exponential-Smoothing" title="Permalink"></a></h1><p><strong>TBATS</strong> (Trigonometric seasonality, Box-Cox transformation, ARMA errors, Trend, and Seasonal components) extends BATS by using a <strong>Fourier representation</strong> for seasonal components, enabling the model to handle:</p><ul><li><strong>Non-integer seasonal periods</strong> (e.g., 52.18 weeks per year)</li><li><strong>Very long seasonal cycles</strong> (hundreds or thousands of periods)</li><li><strong>Multiple complex seasonalities</strong> (daily + weekly + yearly)</li><li><strong>Dual calendar effects</strong> (e.g., Hijri + Gregorian calendars)</li></ul><p>This implementation is a pure Julia port of the R <code>forecast::tbats</code> function based on De Livera, Hyndman &amp; Snyder (2011).</p><hr/><h2 id="Mathematical-Framework"><a class="docs-heading-anchor" href="#Mathematical-Framework">Mathematical Framework</a><a id="Mathematical-Framework-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-Framework" title="Permalink"></a></h2><h3 id="1.-Box-Cox-Transformation"><a class="docs-heading-anchor" href="#1.-Box-Cox-Transformation">1. Box-Cox Transformation</a><a id="1.-Box-Cox-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Box-Cox-Transformation" title="Permalink"></a></h3><p>The model begins with an optional Box-Cox transformation to stabilize variance:</p><p class="math-container">\[y_t^{(\omega)} = \begin{cases}
\frac{y_t^\omega - 1}{\omega}, &amp; \omega \neq 0 \\[6pt]
\ln(y_t), &amp; \omega = 0
\end{cases}\]</p><p>where <span>$\omega \in [0, 1]$</span> is the Box-Cox parameter estimated from the data.</p><hr/><h3 id="2.-TBATS-State-Space-Model"><a class="docs-heading-anchor" href="#2.-TBATS-State-Space-Model">2. TBATS State Space Model</a><a id="2.-TBATS-State-Space-Model-1"></a><a class="docs-heading-anchor-permalink" href="#2.-TBATS-State-Space-Model" title="Permalink"></a></h3><p>The TBATS model is represented in innovations form with the following components:</p><h4 id="**Observation-Equation**"><a class="docs-heading-anchor" href="#**Observation-Equation**"><strong>Observation Equation</strong></a><a id="**Observation-Equation**-1"></a><a class="docs-heading-anchor-permalink" href="#**Observation-Equation**" title="Permalink"></a></h4><p class="math-container">\[y_t^{(\omega)} = \ell_{t-1} + \phi b_{t-1} + \sum_{i=1}^{T} s_{i,t-1} + d_t\]</p><p>where:</p><ul><li><span>$\ell_t$</span> is the local level</li><li><span>$b_t$</span> is the trend component</li><li><span>$\phi$</span> is the damping parameter (<span>$0 &lt; \phi \leq 1$</span>)</li><li><span>$s_{i,t}$</span> is the <span>$i$</span>-th seasonal component</li><li><span>$d_t$</span> is the ARMA error term</li><li><span>$T$</span> is the number of seasonal periods</li></ul><h4 id="**State-Equations**"><a class="docs-heading-anchor" href="#**State-Equations**"><strong>State Equations</strong></a><a id="**State-Equations**-1"></a><a class="docs-heading-anchor-permalink" href="#**State-Equations**" title="Permalink"></a></h4><p><strong>Local Level:</strong></p><p class="math-container">\[\ell_t = \ell_{t-1} + \phi b_{t-1} + \alpha d_t\]</p><p>where <span>$\alpha$</span> is the level smoothing parameter.</p><p><strong>Trend Component:</strong></p><p class="math-container">\[b_t = \phi b_{t-1} + \beta d_t\]</p><p>where <span>$\beta$</span> is the trend smoothing parameter and <span>$\phi$</span> controls damping.</p><p><strong>Trigonometric Seasonal Components:</strong></p><p>For each seasonal period <span>$m_i$</span> with <span>$k_i$</span> Fourier harmonics:</p><p class="math-container">\[s_{i,t} = \sum_{j=1}^{k_i} \left[ s_{i,j,t}^{(1)} \cos(\lambda_{i,j} t) + s_{i,j,t}^{(2)} \sin(\lambda_{i,j} t) \right]\]</p><p>where <span>$\lambda_{i,j} = \frac{2\pi j}{m_i}$</span> is the <span>$j$</span>-th harmonic frequency.</p><p><strong>Harmonic State Evolution:</strong></p><p>Each harmonic pair evolves via a rotation matrix:</p><p class="math-container">\[\begin{pmatrix}
s_{i,j,t}^{(1)} \\
s_{i,j,t}^{(2)}
\end{pmatrix}
= \begin{pmatrix}
\cos\lambda_{i,j} &amp; \sin\lambda_{i,j} \\
-\sin\lambda_{i,j} &amp; \cos\lambda_{i,j}
\end{pmatrix}
\begin{pmatrix}
s_{i,j,t-1}^{(1)} \\
s_{i,j,t-1}^{(2)}
\end{pmatrix}
+ \begin{pmatrix}
\gamma_{1,i} \\
\gamma_{2,i}
\end{pmatrix} d_t\]</p><p>where <span>$\gamma_{1,i}$</span> and <span>$\gamma_{2,i}$</span> are smoothing parameters for the seasonal component.</p><p><strong>ARMA Error Component:</strong></p><p class="math-container">\[d_t = \sum_{k=1}^p \varphi_k d_{t-k} + \varepsilon_t + \sum_{\ell=1}^q \theta_\ell \varepsilon_{t-\ell}\]</p><p>where:</p><ul><li><span>$p$</span> is the AR order</li><li><span>$q$</span> is the MA order</li><li><span>$\varphi_k$</span> are AR coefficients</li><li><span>$\theta_\ell$</span> are MA coefficients</li><li><span>$\varepsilon_t \sim \mathcal{N}(0, \sigma^2)$</span></li></ul><hr/><h3 id="3.-Key-Advantages-Over-BATS"><a class="docs-heading-anchor" href="#3.-Key-Advantages-Over-BATS">3. Key Advantages Over BATS</a><a id="3.-Key-Advantages-Over-BATS-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Key-Advantages-Over-BATS" title="Permalink"></a></h3><table><tr><th style="text-align: right">Feature</th><th style="text-align: right">BATS</th><th style="text-align: right">TBATS</th></tr><tr><td style="text-align: right">Seasonal periods</td><td style="text-align: right">Integer only</td><td style="text-align: right">Non-integer allowed</td></tr><tr><td style="text-align: right">State dimension</td><td style="text-align: right"><span>$m_i$</span> states per season</td><td style="text-align: right"><span>$2k_i$</span> states per season</td></tr><tr><td style="text-align: right">Max seasonal period</td><td style="text-align: right">~350 (computational limit)</td><td style="text-align: right">Unlimited (via Fourier)</td></tr><tr><td style="text-align: right">Dual calendars</td><td style="text-align: right">Not feasible</td><td style="text-align: right">Fully supported</td></tr><tr><td style="text-align: right">Storage</td><td style="text-align: right"><span>$O(m)$</span></td><td style="text-align: right"><span>$O(k)$</span>, typically <span>$k \ll m$</span></td></tr></table><p><strong>Example:</strong> For weekly seasonality (<span>$m = 52$</span>), BATS needs 52 states, while TBATS with <span>$k=2$</span> harmonics needs only 4 states.</p><hr/><h3 id="4.-Forecasting"><a class="docs-heading-anchor" href="#4.-Forecasting">4. Forecasting</a><a id="4.-Forecasting-1"></a><a class="docs-heading-anchor-permalink" href="#4.-Forecasting" title="Permalink"></a></h3><p>Future states evolve deterministically (errors set to zero):</p><p><strong>Level:</strong></p><p class="math-container">\[\ell_{t+h} = \ell_t + \sum_{u=1}^h \phi^{u-1} b_t\]</p><p><strong>Trend:</strong></p><p class="math-container">\[b_{t+h} = \phi^h b_t\]</p><p><strong>Seasonal Components:</strong></p><p>The harmonic pairs rotate forward via matrix powers:</p><p class="math-container">\[\begin{pmatrix}
s_{i,j,t+h}^{(1)} \\
s_{i,j,t+h}^{(2)}
\end{pmatrix}
= R(\lambda_{i,j})^h
\begin{pmatrix}
s_{i,j,t}^{(1)} \\
s_{i,j,t}^{(2)}
\end{pmatrix}\]</p><p>where <span>$R(\lambda)$</span> is the rotation matrix.</p><p><strong>Point Forecast (Transformed Scale):</strong></p><p class="math-container">\[\hat{y}_{t+h}^{(\omega)} = \ell_{t+h} + \phi b_{t+h} + \sum_{i=1}^T s_{i,t+h}\]</p><p>The forecast is then back-transformed via inverse Box-Cox:</p><p class="math-container">\[\hat{y}_{t+h} = \begin{cases}
(\omega \hat{y}_{t+h}^{(\omega)} + 1)^{1/\omega}, &amp; \omega \neq 0 \\[6pt]
\exp(\hat{y}_{t+h}^{(\omega)}), &amp; \omega = 0
\end{cases}\]</p><p><strong>Forecast Variance:</strong></p><p>The <span>$h$</span>-step ahead forecast variance is:</p><p class="math-container">\[\text{Var}(\hat{y}_{t+h}) = \sigma^2 \sum_{j=0}^{h-1} c_j^2\]</p><p>where <span>$c_j$</span> depends on the model&#39;s transition matrix <span>$F$</span> and error vector <span>$g$</span>.</p><hr/><h2 id="Usage-in-Durbyn"><a class="docs-heading-anchor" href="#Usage-in-Durbyn">Usage in Durbyn</a><a id="Usage-in-Durbyn-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-in-Durbyn" title="Permalink"></a></h2><p>Durbyn provides two interfaces for TBATS: the <strong>classic API</strong> with direct function calls and the <strong>grammar interface</strong> for declarative model specification.</p><h3 id="Grammar-Interface-(Recommended)"><a class="docs-heading-anchor" href="#Grammar-Interface-(Recommended)">Grammar Interface (Recommended)</a><a id="Grammar-Interface-(Recommended)-1"></a><a class="docs-heading-anchor-permalink" href="#Grammar-Interface-(Recommended)" title="Permalink"></a></h3><p>The grammar interface provides a unified, declarative way to specify TBATS models using <code>@formula</code> and <code>TbatsSpec</code>:</p><pre><code class="language-julia hljs">using Durbyn
using Durbyn.ModelSpecs

# Create sample data with weekly seasonality (non-integer period)
n = 156  # 3 years of weekly data
t = 1:n
data = (sales = 100.0 .+ 10.0 .* sin.(2π .* t ./ 52.18) .+ 2.0 .* randn(n),)

# Basic TBATS with defaults (automatic component selection)
spec = TbatsSpec(@formula(sales = tbats()))
fitted = fit(spec, data)
fc = forecast(fitted, h = 12)

# TBATS with non-integer weekly seasonality (52.18 weeks/year)
spec = TbatsSpec(@formula(sales = tbats(seasonal_periods=52.18)))
fitted = fit(spec, data)
fc = forecast(fitted, h = 12)

# TBATS with multiple seasonal periods (daily + yearly)
# Example: hourly data with daily (24h) and yearly (8766h ≈ 365.25 days)
spec = TbatsSpec(@formula(sales = tbats(seasonal_periods=[24, 8766])))
fitted = fit(spec, data)
fc = forecast(fitted, h = 12)

# TBATS with explicit Fourier orders
spec = TbatsSpec(@formula(sales = tbats(
    seasonal_periods=[7, 365.25],
    k=[3, 10]  # 3 harmonics for weekly, 10 for yearly
)))
fitted = fit(spec, data)
fc = forecast(fitted, h = 12)

# TBATS with specific component selection
spec = TbatsSpec(@formula(sales = tbats(
    seasonal_periods=52.18,
    use_box_cox=true,
    use_trend=true,
    use_damped_trend=false,
    use_arma_errors=true
)))
fitted = fit(spec, data)
fc = forecast(fitted, h = 12)

# Additional options at fit time
fitted = fit(spec, data, bc_lower=0.0, bc_upper=1.5, biasadj=true)</code></pre><p><strong>Panel Data Support:</strong></p><pre><code class="language-julia hljs"># Create panel data (Tables.jl compatible)
n_per_group = 104  # 2 years of weekly data per group
groups = [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;]

tbl = (
    product = repeat(groups, inner=n_per_group),
    sales = vcat([
        100.0 .+ 10.0 .* sin.(2π .* (1:n_per_group) ./ 52) .+ 2.0 .* randn(n_per_group)
        for _ in groups
    ]...)
)

# Fit TBATS to each product separately
spec = TbatsSpec(@formula(sales = tbats(seasonal_periods=52.18)))
fitted = fit(spec, tbl, groupby = :product)
fc = forecast(fitted, h = 12)</code></pre><p><strong>Model Comparison:</strong></p><pre><code class="language-julia hljs"># Compare TBATS with BATS and other models
models = model(
    TbatsSpec(@formula(sales = tbats(seasonal_periods=52.18))),  # Non-integer period
    BatsSpec(@formula(sales = bats(seasonal_periods=52))),        # Integer period only
    ArimaSpec(@formula(sales = p() + q() + P() + Q())),
    EtsSpec(@formula(sales = e(&quot;Z&quot;) + t(&quot;Z&quot;) + s(&quot;Z&quot;))),
    names = [&quot;tbats&quot;, &quot;bats&quot;, &quot;arima&quot;, &quot;ets&quot;]
)

fitted = fit(models, data)
fc = forecast(fitted, h = 12)</code></pre><h3 id="Classic-API"><a class="docs-heading-anchor" href="#Classic-API">Classic API</a><a id="Classic-API-1"></a><a class="docs-heading-anchor-permalink" href="#Classic-API" title="Permalink"></a></h3><p>For direct usage without the grammar interface:</p><pre><code class="language-julia hljs">using Durbyn

y = rand(100)
m = [7, 365.25]

model = tbats(y, m)

fc = forecast(model, h=20)</code></pre><h3 id="Formula-Interface-(Direct)"><a class="docs-heading-anchor" href="#Formula-Interface-(Direct)">Formula Interface (Direct)</a><a id="Formula-Interface-(Direct)-1"></a><a class="docs-heading-anchor-permalink" href="#Formula-Interface-(Direct)" title="Permalink"></a></h3><p>You can also use the formula interface directly without <code>TbatsSpec</code>:</p><pre><code class="language-julia hljs">using Durbyn

data = (sales = randn(156) .+ 100,)
formula = @formula(sales = tbats(seasonal_periods=52.18))
fit = tbats(formula, data)  # Works with Tables.jl compatible data
fc = forecast(fit, h = 12)</code></pre><h3 id="Key-keyword-arguments"><a class="docs-heading-anchor" href="#Key-keyword-arguments">Key keyword arguments</a><a id="Key-keyword-arguments-1"></a><a class="docs-heading-anchor-permalink" href="#Key-keyword-arguments" title="Permalink"></a></h3><p><strong>Grammar arguments (in <code>@formula</code>):</strong></p><ul><li><code>seasonal_periods</code>: <code>Real</code> or <code>Vector{Real}</code> specifying seasonal period(s) - <strong>can be non-integer</strong></li><li><code>k</code>: <code>Int</code> or <code>Vector{Int}</code> specifying Fourier orders (harmonics per season)</li><li><code>use_box_cox</code>, <code>use_trend</code>, <code>use_damped_trend</code>, <code>use_arma_errors</code>: <code>Bool</code> or <code>nothing</code> to auto-select</li></ul><p><strong>Fit-time arguments:</strong></p><ul><li><code>bc_lower</code>, <code>bc_upper</code>: bounds for the Box–Cox search when enabled</li><li><code>biasadj</code>: apply bias correction during inverse Box–Cox transformation</li><li><code>model</code>: pass a previous <code>TBATSModel</code> to refit the same structure to new data</li></ul><hr/><h2 id="Julia-Implementation-(Array-Interface)"><a class="docs-heading-anchor" href="#Julia-Implementation-(Array-Interface)">Julia Implementation (Array Interface)</a><a id="Julia-Implementation-(Array-Interface)-1"></a><a class="docs-heading-anchor-permalink" href="#Julia-Implementation-(Array-Interface)" title="Permalink"></a></h2><h3 id="Function-Signature"><a class="docs-heading-anchor" href="#Function-Signature">Function Signature</a><a id="Function-Signature-1"></a><a class="docs-heading-anchor-permalink" href="#Function-Signature" title="Permalink"></a></h3><pre><code class="language-julia hljs">tbats(
    y::AbstractVector{&lt;:Real},
    m::Union{Vector{Int}, Nothing} = nothing;
    use_box_cox::Union{Bool, AbstractVector{Bool}, Nothing} = nothing,
    use_trend::Union{Bool, AbstractVector{Bool}, Nothing} = nothing,
    use_damped_trend::Union{Bool, AbstractVector{Bool}, Nothing} = nothing,
    use_arma_errors::Bool = true,
    bc_lower::Real = 0.0,
    bc_upper::Real = 1.0,
    biasadj::Bool = false,
    model = nothing
)</code></pre><h3 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h3><ul><li><strong><code>y</code></strong>: Univariate time series (1D vector)</li><li><strong><code>m</code></strong>: Vector of seasonal periods (can be non-integer). Use <code>nothing</code> for non-seasonal models.</li><li><strong><code>use_box_cox</code></strong>: Whether to use Box-Cox transformation<ul><li><code>nothing</code> (default): tries both and selects by AIC</li><li><code>true/false</code>: forces the choice</li><li>Vector of bools: tries each option</li></ul></li><li><strong><code>use_trend</code></strong>: Whether to include trend component<ul><li><code>nothing</code> (default): tries both</li><li><code>true/false</code>: forces the choice</li></ul></li><li><strong><code>use_damped_trend</code></strong>: Whether to damp the trend<ul><li><code>nothing</code> (default): tries both</li><li><code>true/false</code>: forces the choice</li><li>Ignored if <code>use_trend=false</code></li></ul></li><li><strong><code>use_arma_errors</code></strong>: Whether to model residuals with ARMA</li><li><strong><code>bc_lower</code>, <code>bc_upper</code></strong>: Bounds for Box-Cox parameter search</li><li><strong><code>biasadj</code></strong>: Use bias-adjusted back-transformation for forecasts</li><li><strong><code>model</code></strong>: Previously fitted TBATS model to refit</li></ul><h3 id="Returns"><a class="docs-heading-anchor" href="#Returns">Returns</a><a id="Returns-1"></a><a class="docs-heading-anchor-permalink" href="#Returns" title="Permalink"></a></h3><p>A <code>TBATSModel</code> struct containing:</p><ul><li><code>lambda</code>: Box-Cox parameter (or <code>nothing</code>)</li><li><code>alpha</code>: Level smoothing parameter</li><li><code>beta</code>: Trend smoothing parameter (or <code>nothing</code>)</li><li><code>damping_parameter</code>: Damping parameter φ (or <code>nothing</code>)</li><li><code>gamma_one_values</code>: First seasonal smoothing parameters</li><li><code>gamma_two_values</code>: Second seasonal smoothing parameters</li><li><code>ar_coefficients</code>: AR coefficients (or <code>nothing</code>)</li><li><code>ma_coefficients</code>: MA coefficients (or <code>nothing</code>)</li><li><code>seasonal_periods</code>: Vector of seasonal periods</li><li><code>k_vector</code>: Vector of Fourier orders per seasonal period</li><li><code>fitted_values</code>: In-sample fitted values</li><li><code>errors</code>: Residuals</li><li><code>x</code>: State matrix</li><li><code>seed_states</code>: Initial states</li><li><code>variance</code>: Residual variance</li><li><code>AIC</code>: Akaike Information Criterion</li><li><code>likelihood</code>: Log-likelihood</li><li><code>y</code>: Original time series</li><li><code>method</code>: Model descriptor string</li></ul><hr/><h2 id="Model-Selection"><a class="docs-heading-anchor" href="#Model-Selection">Model Selection</a><a id="Model-Selection-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Selection" title="Permalink"></a></h2><p>The implementation automatically selects:</p><ol><li><p><strong>Fourier orders (<span>$k_i$</span>)</strong> for each seasonal period via AIC</p><ul><li>Starts with <span>$k=1$</span></li><li>For small periods (<span>$m \leq 12$</span>): searches downward from <span>$k = \lfloor(m-1)/2\rfloor$</span></li><li>For large periods (<span>$m &gt; 12$</span>): uses step-up/step-down search around <span>$k \in \{5,6,7\}$</span></li></ul></li><li><p><strong>ARMA orders</strong> using <code>auto_arima</code> on residuals</p></li><li><p><strong>Box-Cox parameter</strong> via profile likelihood</p></li><li><p><strong>Trend and damping</strong> via AIC comparison</p></li></ol><p>The descriptor format matches R&#39;s <code>forecast::tbats</code>:</p><pre><code class="nohighlight hljs">TBATS(omega, {p,q}, phi, &lt;m1,k1&gt;, &lt;m2,k2&gt;, ...)</code></pre><p>Example: <code>TBATS(0.001, {0,0}, 0.98, &lt;7,3&gt;, &lt;365.25,10&gt;)</code></p><hr/><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><h3 id="Example-1:-Weekly-Data-with-Non-Integer-Seasonality"><a class="docs-heading-anchor" href="#Example-1:-Weekly-Data-with-Non-Integer-Seasonality">Example 1: Weekly Data with Non-Integer Seasonality</a><a id="Example-1:-Weekly-Data-with-Non-Integer-Seasonality-1"></a><a class="docs-heading-anchor-permalink" href="#Example-1:-Weekly-Data-with-Non-Integer-Seasonality" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Durbyn

y = randn(520)
m = 52.18

model = tbats(y, m)
println(model)

fc = forecast(model, h=52)</code></pre><p><strong>Output:</strong></p><pre><code class="nohighlight hljs">TBATS(0.112, {0,0}, -, &lt;52.18,5&gt;)

Parameters:
  Lambda:  0.1120
  Alpha:   0.0823
  Gamma-1: 0.0045, 0.0032, 0.0019, 0.0011, 0.0007
  Gamma-2: 0.0051, 0.0036, 0.0024, 0.0015, 0.0009

Sigma:   0.9876
AIC:     1523.45</code></pre><h3 id="Example-2:-Multiple-Seasonalities-(Daily-Weekly-Yearly)"><a class="docs-heading-anchor" href="#Example-2:-Multiple-Seasonalities-(Daily-Weekly-Yearly)">Example 2: Multiple Seasonalities (Daily + Weekly + Yearly)</a><a id="Example-2:-Multiple-Seasonalities-(Daily-Weekly-Yearly)-1"></a><a class="docs-heading-anchor-permalink" href="#Example-2:-Multiple-Seasonalities-(Daily-Weekly-Yearly)" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Durbyn, Dates

n = 365 * 3
t = 1:n
y = 100 .+ 10 .* sin.(2π .* t ./ 365.25) .+     # yearly
    5 .* sin.(2π .* t ./ 7) .+                   # weekly
    2 .* randn(n)                                # noise

model = tbats(y, [7, 365.25])
println(model)

fc = forecast(model, h=30)</code></pre><h3 id="Example-3:-Dual-Calendar-Effects-(Gregorian-Hijri)"><a class="docs-heading-anchor" href="#Example-3:-Dual-Calendar-Effects-(Gregorian-Hijri)">Example 3: Dual Calendar Effects (Gregorian + Hijri)</a><a id="Example-3:-Dual-Calendar-Effects-(Gregorian-Hijri)-1"></a><a class="docs-heading-anchor-permalink" href="#Example-3:-Dual-Calendar-Effects-(Gregorian-Hijri)" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Durbyn

m_gregorian = 365.25
m_hijri = 354.37

y = load_data()  # Data with both calendar effects

model = tbats(y, [m_gregorian, m_hijri])
println(model)</code></pre><p><strong>Output:</strong></p><pre><code class="nohighlight hljs">TBATS(0.234, {1,1}, 0.975, &lt;365.25,8&gt;, &lt;354.37,7&gt;)</code></pre><h3 id="Example-4:-Forcing-Model-Components"><a class="docs-heading-anchor" href="#Example-4:-Forcing-Model-Components">Example 4: Forcing Model Components</a><a id="Example-4:-Forcing-Model-Components-1"></a><a class="docs-heading-anchor-permalink" href="#Example-4:-Forcing-Model-Components" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Durbyn

y = randn(200)
m = [7, 30]

model = tbats(
    y, m;
    use_box_cox = false,           # No transformation
    use_trend = true,              # Force trend
    use_damped_trend = true,       # Force damping
    use_arma_errors = false        # No ARMA errors
)</code></pre><h3 id="Example-5:-High-Frequency-Data-(5-minute-intervals)"><a class="docs-heading-anchor" href="#Example-5:-High-Frequency-Data-(5-minute-intervals)">Example 5: High-Frequency Data (5-minute intervals)</a><a id="Example-5:-High-Frequency-Data-(5-minute-intervals)-1"></a><a class="docs-heading-anchor-permalink" href="#Example-5:-High-Frequency-Data-(5-minute-intervals)" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Durbyn

minutes_per_day = 288      # 24 * 60 / 5
minutes_per_week = 2016    # 7 * 288

y = load_call_center_data()

model = tbats(y, [minutes_per_day, minutes_per_week])

println(&quot;State dimension: &quot;, size(model.x, 1))
println(&quot;Seasonal periods: &quot;, model.seasonal_periods)
println(&quot;Fourier orders: &quot;, model.k_vector)</code></pre><hr/><h2 id="Forecasting"><a class="docs-heading-anchor" href="#Forecasting">Forecasting</a><a id="Forecasting-1"></a><a class="docs-heading-anchor-permalink" href="#Forecasting" title="Permalink"></a></h2><h3 id="Basic-Forecasting"><a class="docs-heading-anchor" href="#Basic-Forecasting">Basic Forecasting</a><a id="Basic-Forecasting-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Forecasting" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Durbyn

model = tbats(y, [7, 365.25])

fc = forecast(model, h=30)

println(&quot;Point forecasts: &quot;, fc.mean)
println(&quot;80% CI: &quot;, fc.lower[:, 1], &quot; to &quot;, fc.upper[:, 1])
println(&quot;95% CI: &quot;, fc.lower[:, 2], &quot; to &quot;, fc.upper[:, 2])</code></pre><h3 id="Forecast-Options"><a class="docs-heading-anchor" href="#Forecast-Options">Forecast Options</a><a id="Forecast-Options-1"></a><a class="docs-heading-anchor-permalink" href="#Forecast-Options" title="Permalink"></a></h3><pre><code class="language-julia hljs">fc = forecast(
    model;
    h = 50,                          # Forecast horizon
    level = [80, 95],                # Confidence levels
    fan = false,                     # Fan chart levels
    biasadj = nothing                # Bias adjustment (inherits from model)
)</code></pre><h3 id="Fan-Charts"><a class="docs-heading-anchor" href="#Fan-Charts">Fan Charts</a><a id="Fan-Charts-1"></a><a class="docs-heading-anchor-permalink" href="#Fan-Charts" title="Permalink"></a></h3><pre><code class="language-julia hljs">fc = forecast(model, h=30, fan=true)

println(&quot;Confidence levels: &quot;, fc.level)  # [51, 54, 57, ..., 99]</code></pre><hr/><h2 id="Model-Diagnostics"><a class="docs-heading-anchor" href="#Model-Diagnostics">Model Diagnostics</a><a id="Model-Diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Model-Diagnostics" title="Permalink"></a></h2><h3 id="Fitted-Values-and-Residuals"><a class="docs-heading-anchor" href="#Fitted-Values-and-Residuals">Fitted Values and Residuals</a><a id="Fitted-Values-and-Residuals-1"></a><a class="docs-heading-anchor-permalink" href="#Fitted-Values-and-Residuals" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Durbyn

model = tbats(y, m)

fitted_vals = fitted(model)
residuals_vals = residuals(model)

using Statistics
println(&quot;RMSE: &quot;, sqrt(mean(residuals_vals .^ 2)))
println(&quot;MAE: &quot;, mean(abs.(residuals_vals)))</code></pre><h3 id="Checking-ARMA-Adequacy"><a class="docs-heading-anchor" href="#Checking-ARMA-Adequacy">Checking ARMA Adequacy</a><a id="Checking-ARMA-Adequacy-1"></a><a class="docs-heading-anchor-permalink" href="#Checking-ARMA-Adequacy" title="Permalink"></a></h3><pre><code class="language-julia hljs">using StatsPlots, Statistics

model = tbats(y, m, use_arma_errors=true)

resid = residuals(model)

autocor(resid, 1:20) |&gt; plot</code></pre><h3 id="Information-Criteria"><a class="docs-heading-anchor" href="#Information-Criteria">Information Criteria</a><a id="Information-Criteria-1"></a><a class="docs-heading-anchor-permalink" href="#Information-Criteria" title="Permalink"></a></h3><pre><code class="language-julia hljs">model = tbats(y, m)

println(&quot;AIC: &quot;, model.AIC)
println(&quot;Log-likelihood: &quot;, model.likelihood)
println(&quot;Parameters: &quot;, length(model.parameters[:vect]))
println(&quot;States: &quot;, size(model.seed_states, 1))</code></pre><hr/><h2 id="Computational-Considerations"><a class="docs-heading-anchor" href="#Computational-Considerations">Computational Considerations</a><a id="Computational-Considerations-1"></a><a class="docs-heading-anchor-permalink" href="#Computational-Considerations" title="Permalink"></a></h2><h3 id="State-Space-Dimension"><a class="docs-heading-anchor" href="#State-Space-Dimension">State Space Dimension</a><a id="State-Space-Dimension-1"></a><a class="docs-heading-anchor-permalink" href="#State-Space-Dimension" title="Permalink"></a></h3><p>For a TBATS model with:</p><ul><li>Trend: 2 states (<span>$\ell_t$</span>, <span>$b_t$</span>)</li><li><span>$T$</span> seasonal components with Fourier orders <span>$k_1, \ldots, k_T$</span>: <span>$2\sum_{i=1}^T k_i$</span> states</li><li>ARMA(<span>$p$</span>, <span>$q$</span>): <span>$p + q$</span> states</li></ul><p><strong>Total states:</strong> <span>$2 + 2\sum k_i + p + q$</span></p><p><strong>Example:</strong></p><ul><li>Daily (<span>$m=288$</span>, <span>$k=5$</span>): 10 states</li><li>Weekly (<span>$m=2016$</span>, <span>$k=7$</span>): 14 states</li><li>Total: <span>$2 + 10 + 14 = 26$</span> states</li></ul><p>Compare to BATS: <span>$2 + 288 + 2016 = 2306$</span> states!</p><h3 id="Choosing-Fourier-Orders"><a class="docs-heading-anchor" href="#Choosing-Fourier-Orders">Choosing Fourier Orders</a><a id="Choosing-Fourier-Orders-1"></a><a class="docs-heading-anchor-permalink" href="#Choosing-Fourier-Orders" title="Permalink"></a></h3><p>The implementation automatically selects <span>$k_i$</span> via AIC, but general guidelines:</p><ul><li><strong>Short periods</strong> (<span>$m &lt; 12$</span>): use <span>$k \approx m/2$</span></li><li><strong>Medium periods</strong> (<span>$m = 12$</span> to <span>$100$</span>): use <span>$k \in [3, 10]$</span></li><li><strong>Long periods</strong> (<span>$m &gt; 100$</span>): use <span>$k \in [5, 15]$</span></li><li><strong>Very long periods</strong> (<span>$m &gt; 1000$</span>): use <span>$k \in [10, 20]$</span></li></ul><p>Higher <span>$k$</span> captures more complex seasonal shapes but increases computation.</p><hr/><h2 id="Empirical-Results-(From-De-Livera-et-al.-2011)"><a class="docs-heading-anchor" href="#Empirical-Results-(From-De-Livera-et-al.-2011)">Empirical Results (From De Livera et al. 2011)</a><a id="Empirical-Results-(From-De-Livera-et-al.-2011)-1"></a><a class="docs-heading-anchor-permalink" href="#Empirical-Results-(From-De-Livera-et-al.-2011)" title="Permalink"></a></h2><h3 id="1.-Weekly-U.S.-Gasoline-Demand"><a class="docs-heading-anchor" href="#1.-Weekly-U.S.-Gasoline-Demand">1. Weekly U.S. Gasoline Demand</a><a id="1.-Weekly-U.S.-Gasoline-Demand-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Weekly-U.S.-Gasoline-Demand" title="Permalink"></a></h3><ul><li><strong>Seasonal period:</strong> 52.18 weeks/year</li><li><strong>Result:</strong> TBATS outperforms BATS because seasonality is non-integer</li><li><strong>MASE improvement:</strong> 8.3%</li></ul><h3 id="2.-Call-Center-Arrivals-(5-minute-intervals)"><a class="docs-heading-anchor" href="#2.-Call-Center-Arrivals-(5-minute-intervals)">2. Call Center Arrivals (5-minute intervals)</a><a id="2.-Call-Center-Arrivals-(5-minute-intervals)-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Call-Center-Arrivals-(5-minute-intervals)" title="Permalink"></a></h3><ul><li><strong>Seasonal periods:</strong> 169 (daily), 845 (weekly)</li><li><strong>BATS states:</strong> 1014</li><li><strong>TBATS states:</strong> 24 (with <span>$k_1=5$</span>, <span>$k_2=7$</span>)</li><li><strong>Result:</strong> 40× reduction in state dimension with better forecasts</li></ul><h3 id="3.-Turkish-Electricity-Consumption"><a class="docs-heading-anchor" href="#3.-Turkish-Electricity-Consumption">3. Turkish Electricity Consumption</a><a id="3.-Turkish-Electricity-Consumption-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Turkish-Electricity-Consumption" title="Permalink"></a></h3><ul><li><strong>Calendars:</strong> Gregorian (365.25) + Hijri (354.37)</li><li><strong>Result:</strong> BATS cannot handle non-integer dual calendars; TBATS is the only feasible model</li><li><strong>MASE improvement over ETS:</strong> 23.1%</li></ul><hr/><h2 id="Comparison:-BATS-vs-TBATS"><a class="docs-heading-anchor" href="#Comparison:-BATS-vs-TBATS">Comparison: BATS vs TBATS</a><a id="Comparison:-BATS-vs-TBATS-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison:-BATS-vs-TBATS" title="Permalink"></a></h2><table><tr><th style="text-align: right">Scenario</th><th style="text-align: right">Use BATS</th><th style="text-align: right">Use TBATS</th></tr><tr><td style="text-align: right">Integer seasonal period</td><td style="text-align: right">✓</td><td style="text-align: right">✓</td></tr><tr><td style="text-align: right">Non-integer seasonal period</td><td style="text-align: right">✗</td><td style="text-align: right">✓</td></tr><tr><td style="text-align: right">Short seasonal period (<span>$m &lt; 50$</span>)</td><td style="text-align: right">✓</td><td style="text-align: right">✓</td></tr><tr><td style="text-align: right">Long seasonal period (<span>$m &gt; 350$</span>)</td><td style="text-align: right">✗</td><td style="text-align: right">✓</td></tr><tr><td style="text-align: right">Multiple integer seasons</td><td style="text-align: right">✓</td><td style="text-align: right">✓</td></tr><tr><td style="text-align: right">Dual calendars</td><td style="text-align: right">✗</td><td style="text-align: right">✓</td></tr><tr><td style="text-align: right">Memory-constrained</td><td style="text-align: right">✗</td><td style="text-align: right">✓</td></tr></table><p><strong>Rule of thumb:</strong> Use TBATS when:</p><ul><li>Any seasonal period is non-integer</li><li>Any seasonal period exceeds 100</li><li>You have dual calendar effects</li><li>Memory/computation is limited</li></ul><hr/><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>De Livera, A.M., Hyndman, R.J., &amp; Snyder, R.D. (2011). <a href="https://www.tandfonline.com/doi/abs/10.1198/jasa.2011.tm09771"><em>Forecasting time series with complex seasonal patterns using exponential smoothing</em>.</a> Journal of the American Statistical Association, 106(496), 1513-1527.</p><hr/><h2 id="See-Also"><a class="docs-heading-anchor" href="#See-Also">See Also</a><a id="See-Also-1"></a><a class="docs-heading-anchor-permalink" href="#See-Also" title="Permalink"></a></h2><ul><li><a href="../bats/">BATS Documentation</a> - Integer seasonal periods only</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bats/">« BATS</a><a class="docs-footer-nextpage" href="../intermittent/">Intermittent Demand »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 26 January 2026 18:27">Monday 26 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
